<div class="c-program">
    <div class="c-program-card" onclick="openModal(event)">
        <div class="c-program-card__media">  
                <img decoding="async" class="c-program-card__image" src="${imageLink}" alt="${program.title}" loading="lazy">
        </div>
        <div class="c-program-card__content">
            ${program.date ? `<h5 class="c-program-card__date">${program.date.replace(/\n/g, '<br>')}</h5>` : noPropertyWarn(program, 'date')}
            <h3 class="c-program-card__title">${program.title.replace(/\n/g, '<br>')}</h3>
        </div>
    </div>
    <dialog class="c-show-window">
        <img decoding="async" lazy src="https://dossiersdepresse.be/wp-content/uploads/2023/12/bokeh.png" class="c-show-window__deco"/>
        <button class="c-show-window__focus""></button>
        <div class="c-show-window__container">
            <div class="c-show-window__media">
                <img decoding="async" class="c-show-window__image" src="${imageLink}" alt="${program.title}" loading="lazy">
            </div>
            <div class="c-show-window__content">
                <div class="c-show-window__title-group">
                    ${program.date ? `<h4 class="c-show-window__date">${program.date}</h4>` : noPropertyWarn(program, 'date')}
                    ${program.title ? `<h3 class="c-show-window__name">${program.title}</h3>` : noPropertyWarn(program, 'title')}
                    ${program.presenters ? `<h4 class="c-show-window__presentators">${program.presenters.join(', ').replace(/\n/g, '<br>')}</h4>` : noPropertyWarn(program, 'presenters')}
                </div>

                ${program.description ? `
                    <p class="c-show-window__description">${program.description.replace(/\n/g, '<br>')}</p>`
        : noPropertyWarn(program, 'description')}
        
        ${program.video ? `
                     <a class="c-show-window__video-link" href="${program.video}" target="_blank"> 
                        <svg width="43" height="42" viewBox="0 0 43 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21.0938 38.5C30.7587 38.5 38.5938 30.665 38.5938 21C38.5938 11.335 30.7587 3.5 21.0938 3.5C11.4288 3.5 3.59375 11.335 3.59375 21C3.59375 30.665 11.4288 38.5 21.0938 38.5Z" stroke="#CCA552" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M17.5938 14L28.0938 21L17.5938 28V14Z" stroke="#CCA552" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>

                            <p class="c-show-window__video-text">Voir la vidéo</p>
                        </a>
                        `
        : ''}


                <div class="c-show-window__footer">
                    <ul class="c-show-window__channels">
                        ${program.channels.map(channel => `
                            ${programChannels[channel] == undefined ? noPropertyWarn(program, [channel] + ' icon') : ''}
                            <li class="c-show-window__channel">
                                <a class="c-show-window__channel-link" href="${programChannels[channel].link}" target="_blank">
                                    <img decoding="async" tabindex="-1" class="c-show-window__channel-icon" src="${iconPath + "RTL_" + channel}.svg" alt="${programChannels[channel].name} logo" loading="lazy">
                                </a>
                            </li>
                        `).join('')}
                    </ul>

                    ${program.link ? `
                        <a class="c-show-window__link"  href="${program.link}" target="_blank">
                            <img decoding="async" class="c-show-window__link-icon" tabindex="-1" src="https://dossiersdepresse.be/wp-content/uploads/2023/12/arrow-right-circle.svg" alt="right arrow svg" loading="lazy">
                        </a>`
        : ''}
                </div>
            </div>
            </div>
            <button class="c-show-window__retour" onclick="this.parentElement.close()">←  Retour</button>
    </dialog>
</div>

<style>

.c-program-card-container {
display: flex;
flex-direction: row;
justify-content: flex-start;
align-items: center;
flex-wrap: wrap;
gap: 60px;
width: 100%;
}

.c-program{
width: 100%;
max-width: 350px;
}

.c-program-card {
position: relative;
display: flex;
flex-direction: column;
justify-content: flex-end;
align-items: center;

width: 100%;
aspect-ratio: 1/1.41;
box-sizing: border-box;

border-radius: 25px;
overflow: hidden;
cursor: pointer;

gap: 24px;

box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.5);
}

.c-program-card__content {
display: flex;
flex-direction: column;
align-items: center;
padding: 24px;
box-sizing: border-box;
color: #fff;
z-index: 100;
}

.c-program-card__date {
font-size: 1.5rem;
font-weight: 500;
margin: 0;

opacity: 0;
transform: translate3d(0, 25px, 0);
transition: opacity 0.4s ease-in-out 0.3s, transform 0.4s ease-in-out 0.3s;
}

.c-program-card__title {
font-size: 2rem;
font-weight: 800;
margin: 0;
text-align: center;
transform-origin: bottom center;
transition: transform 0.4s ease-in-out 0.1s;

}

.c-program-card__media {
position: absolute;
top: 0;
left: 0;
bottom: 0;
right: 0;
}

.c-program-card__image {
width: 100%;
height: 100%;

object-fit: cover;
transition: transform 0.4s ease-in-out;
}

.c-program-card__media::before {
content: "";
position: absolute;
top: -20px;
left: -20px;
bottom: -20px;
right: -20px;

background: linear-gradient(180deg, rgba(23, 28, 56, 0.00) 60%, rgba(18, 31, 47, 0.30) 100%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 60%, rgba(0, 0, 0, 0.50) 100%);
mix-blend-mode: multiply;
filter: blur(10px);
z-index: 1;
}

/* Hover state */

.c-program-card:hover .c-program-card__date {
opacity: 9;
transform: translate3d(0, 0, 0);
transition: opacity 0.4s ease-in-out 0.2s, transform 0.4s ease-in-out 0.2s;
}

.c-program-card:hover .c-program-card__title {
opacity: 9;
transform: scale(1.05);

transition: transform 0.4s ease-in-out 0.1s;
}

.c-program-card:hover .c-program-card__image {
transform: scale(1.05);
transition: transform 0.4s ease-in-out;
}


dialog {
border: none;
z-index: 1000;
}

dialog::backdrop {
background-color: rgba(0, 0, 0, 0.5);
backdrop-filter: blur(5px);
}

.c-show-window[open] {
position: fixed;
padding: 0px 0 75px 0;
box-sizing: border-box;
background: linear-gradient(180deg, #0E1B3E00 49.9999%, #0E1B3E 50%);

color: #fff;
width: 85%;
max-width: 650px;
height: fit-content;
max-height: 90%;
border-radius: 25px;
}

@media all and (max-width: 750px) {
.c-show-window[open] {
width: 95%;
max-width: 100%;
}
}

/* Hide scrollbar for Chrome, Safari and Opera */
.c-show-window[open]::-webkit-scrollbar {
display: none;
}

/* Hide scrollbar for IE, Edge, and Firefox */
.c-show-window[open] {
-ms-overflow-style: none;  /* IE and Edge */
scrollbar-width: none;  /* Firefox */
}

.c-show-window[open]::before{
content: "";
position: absolute;
top: 200px;
left: 0;
bottom: 0;
right: 0;
border-radius: 25px;
background-color: #0E1B3E;
}


.c-show-window__container{
display: flex;
flex-direction: column;
align-items: center;
gap: 24px;
width: 100%;
margin-top: 75px;
height: fit-content;
overflow-y: visible;
}

.c-show-window__focus {
opacity: 0;
height: 0;
padding: 0;
margin: 0;
outline: none;
}


.c-show-window__media {
position: relative;

width: 85%;
min-height: 200px;
height: 30vh;
overflow: hidden;
margin-bottom: 24px;
z-index: 1000;
filter: drop-shadow(0px 5px 30px rgba(0, 0, 0, 0.5));
}

.c-show-window__image {
width: 10%;
height: 100%;
border-radius: 5px !important;
}


.c-show-window__content {
position: relative;
display: flex;
flex-direction: column;
align-items: center;
padding: 0px 75px;
gap: 42px;
z-index: 900;
background-color: #0E1B3E;
}
.c-show-window__content::before{
content: "";
position: absolute;
top: -150px;
left: 0;
bottom: 0;
right: 0;
z-index: -1;
background-color: #0E1B3E;
}

@media all and (max-width: 750px) {
.c-show-window__content {
padding: 0 60px;
}
}

@media all and (max-width: 540px) {
.c-show-window__content {
padding: 0 24px;
}
}

.c-show-window__title-group{
display: flex;
flex-direction: column;
align-items: center;
gap: 0px;
}


.c-show-window__date {
font-size: 1.5rem;
font-weight: 500;
opacity: .9;
margin: 0;
text-align: center;
}

.c-show-window__name {
font-size: clamp(2rem, 5vw, 4rem);
font-weight: 800;
line-height: 1;
margin: 0;
text-align: center;
}

.c-show-window__presentators {
font-size: 1rem;
font-weight: 500;
opacity: .7;
margin: 0;
text-align: center;
width: 75%;
}

.c-show-window__description {
font-size: 1rem;
line-height: 1.5;
font-weight: 500;
margin: 0;

transition: max-height 0.4s ease-out;
}

.c-show-window__footer {
display: flex;
flex-direction: row;
justify-content: center;
align-items: center;
width: 100%;
}

.c-show-window__link {
margin-left: auto;
padding: 12px;
}

.c-show-window__link svg {
transition: all 0.3s ease-in-out;
}

.c-show-window__link:hover>svg {
transform: scale(1.05);
transition: all 0.3s ease-in-out;
}

.c-show-window__channels {
display: flex;
flex-direction: row;
flex-wrap: wrap;
height: 35px !important;
gap: 18px;

list-style: none;
padding: 0;
margin: 0;
}

.c-show-window__channel {
height: 100%;
}

.c-show-window__channel-link:hover .c-show-window__channel-icon {
transform: scale(1.02);
transition: all 0.4s ease-in-out;
}

.c-show-window__channel-icon {
height: 100% !important;
transition: all 0.4s ease-in-out;
}

</style>

<script>
    function openModal(e) {

const modal = e.currentTarget.parentElement.querySelector('dialog');
modal.focus();
modal.addEventListener("click", e => {
    const dialogDimensions = modal.getBoundingClientRect()
    if (
        e.clientX < dialogDimensions.left ||
        e.clientX > dialogDimensions.right ||
        e.clientY < dialogDimensions.top ||
        e.clientY > dialogDimensions.bottom
    ) {
        enableScroll();
        modal.close()
    }
})

const btnAndLinks = modal.querySelectorAll('a, button');
btnAndLinks.forEach(btnOrLink => {
    console.log(btnOrLink)
    btnOrLink.blur();
});

modal.showModal();
// prevent scrolling
disableScroll();
}

function disableScroll() {
// Get the current page scroll position
scrollTop =
window.scrollY || document.documentElement.scrollTop;
scrollLeft =
window.scrollX || document.documentElement.scrollLeft,

    // if any scroll is attempted,
    // set this to the previous value
    window.onscroll = function() {
        window.scrollTo(scrollLeft, scrollTop);
    };
}

function enableScroll() {
window.onscroll = function() {};
}
</script>